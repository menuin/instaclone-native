# ğŸ‰ DEVLOG 8/2



### #16.2  Header Domination

- headerë¥¼ ì‚¬ìš©ìì— ë”°ë¼ dynamic í•˜ê²Œ ë°”ê¾¸ê¸° (componentë¥¼ í—¤ë”ì— ë„£ê¸°)

- route objectì— ì»´í¬ë„ŒíŠ¸ë¡œ ë³´ë‚´ì§„ parameterë“¤ì´ ë‹´ê¹€

  ```js
  export default function Profile({navigation, route}) {
  ```

- navigation objectì˜ setOptions ì‚¬ìš©

```js
useEffect(() => {
    if (route?.params?.username) {
        navigation.setOptions({
        title: route.params.username,
        })
}
}, [])
```



- Me screen í—¤ë”ì— ë‚´ username ëœ¨ê²Œ í•˜ê¸°

  - useMe hookì¶”ê°€ (í”„ë¡ íŠ¸ì—ì„œ ê°€ì ¸ì˜´)
  - ìœ„ë‘ ë˜‘ê°™ì´ í•¨

  ```js
  // Me.js
      const { data } = useMe();
      useEffect(() => {
          navigation.setOptions({
              title: data?.me?.username,
          })
      }, [])
  ```



### #16.3 Search part 1

- í—¤ë”ì— ì»´í¬ë„ŒíŠ¸ë¥¼ ë„£ì„ ìˆ˜ ìˆìŒ

```js
// Search.js
const SearchBox = () => {
        return (
            <TextInput
                style={{ backgroundColor: "white" }}
                placeholderTextColor="black"
                placeholder="Search photos"
                autoCapitalize="none"
                returnKeyType="search" />
        )
    }
    useEffect(() => {
        navigation.setOptions({
            headerTitle: SearchBox,
        })
    }, [])
```

- dismissKeyboard (loginì—ì„œ í–ˆì—ˆìŒ #14.8) ì»´í¬ë„ŒíŠ¸ë¡œ ë¹¼ê¸°

 

- state ë§Œë“¤ê¸°

```js
const { setValue, register, watch } = useForm();

    const SearchBox = () => {
        return (
            <TextInput
	
                onChangeText={(text) => setValue("keyword", text)} />
        )
    }
    
useEffect(() => {
    navigation.setOptions({
        headerTitle: SearchBox,
    })
    register("keyword")
}, []);
```



### #16.4 Search part 2

- tab bar ì— user profile iconì„ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ í”„ë¡œí•„ ì‚¬ì§„ìœ¼ë¡œ ë°”ê¾¸ê¸°
  - useMe : user id, username, avatarë¥¼ ì¤Œ, í•œë²ˆë§Œ ì‹¤í–‰ë˜ê³  cacheì— ì €ì¥, ë§¤ë²ˆ apië¥¼ ë³´ë‚´ì§€ x 

```js
const {data} = useMe();

tabBarIcon: ({ focused, color, size }) => (
                    data?.me?.avatar ? <Image source={{uri:data.me.avatar}}/> : <TabIcon iconName={"person"} color={color} focused={focused} />)
            }} >
```

- - ë„¤íŠ¸ì›Œí¬ ì´ë¯¸ì§€ëŠ” ë°˜ë“œì‹œ height, widthê°€ í•„ìš”

```js
style={{ height: 20, width: 20, borderRadius: 10, ...(focused && { borderColor: "white", borderWidth: 2 }) }}
```



- searchPhotos
  - ì¿¼ë¦¬ ì‘ì„±
  - useQueryëŠ” componentê°€ mount ë  ë•Œ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ê¸°ë•Œë¬¸ì— ì‚¬ìš© x, ì‚¬ìš©ìê°€ ê²€ìƒ‰í• ë•Œë§Œ ì¿¼ë¦¬ ì‹¤í–‰ (lazy query)

```js
const [startQueryFn,{loading, data}] = useLazyQuery(SEARCH_PHOTOS)
// startQueryFn í•¨ìˆ˜ë¥¼ ë¶€ë¥¼ ë•Œ ì¿¼ë¦¬ ì‹¤í–‰
```



### #16.5 Search part 3

- TextInput `onSubmitEditing={startQueryFn}`

- watch : ëª¨ë“  renderì—ì„œ refreshë¨

```js
const [startQueryFn, { loading, data }] = useLazyQuery(SEARCH_PHOTOS, {
    variables: {
        keyword: watch("keyword"),
    }
})
```

- ê²€ìƒ‰ì°½ì„ submit í–ˆì„ ë•Œë§Œ ì¿¼ë¦¬ ì‹¤í–‰
- **called** : í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ 
  -  submití•˜ê¸° ì „ì—ëŠ” Search by keyword ì¶œë ¥

```js
const [startQueryFn, { loading, data, called }] = useLazyQuery(SEARCH_PHOTOS, {
    variables: {
        keyword: watch("keyword"),
    },
});
...

{!called ? (
    <SearchingContainer>
    <SearchingText>Search by keyword</SearchingText>
    </SearchingContainer>
) : null}
```

- ë¬¸ì œ : í•œ ê¸€ìë¥¼ ì…ë ¥í•  ë•Œë§ˆë‹¤ re-renderí•˜ê³  ìˆìŒ(watch ë•Œë¬¸)
- í•´ê²° : onValid function ì‚¬ìš© (data ë„˜ì–´ê°)

```js
const onValid = ({ keyword }) => {
    startQueryFn({
        variables: {
            keyword
        }
    });
}

...
<TextInput
	...
	onSubmitEditing={handleSubmit(onValid)}
/>
                     
...
    useEffect(() => {
        ...
        register("keyword", {
            required: true,
            minLength: 3,
        })
    }, []);
```

- search ê²°ê³¼ê°€ ì—†ì„ ê²½ìš°ë„ ë¶„ê¸°

```js
{data?.searchPhotos !== undefined && 
    data?.searchPhotos?.length === 0 ? (
    <MessageContainer>
    <MessageText>Could not find anything.</MessageText>
    </MessageContainer>
) : null}
```

