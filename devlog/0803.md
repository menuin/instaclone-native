# ğŸ‚ DEVLOG 8/3

### #17.2 Select Photo part 1

- UploadNavì˜ select í—¤ë” ë‹¤ë“¬ê¸° (ì½”ë“œ ì°¸ê³ )

- selectPhoto ì»´í¬ë„ŒíŠ¸ ìˆ˜ì •
  1. ìœ ì €ê°€ ê³ ë¥¸ ì‚¬ì§„ì„ ìƒë‹¨ì— ë„ì›€
  2. ê°¤ëŸ¬ë¦¬ì— ìˆëŠ” ëª¨ë“  ì‚¬ì§„ë“¤ì„ í•˜ë‹¨ì— ë‚˜ì—´



### #17.3 Select Photo part 2

- ê°¤ëŸ¬ë¦¬ ì‚¬ì§„ ê°€ì ¸ì˜¤ê¸°

- expo api ì‚¬ìš© 

  expo - MediaLibrary

  https://docs.expo.dev/versions/latest/sdk/media-library/




1. ê°¤ëŸ¬ë¦¬ ì ‘ê·¼ ê¶Œí•œ ìš”ì²­í•˜ê¸°
   - getPermissionsAsync, requestPermissionsAsync

```js
// SelectPhoto.js
    const [ok, setOk] = useState(false);

    const getPermissions = async () => {
        const { accessPrivileges, canAskAgain } = await MediaLibrary.getPermissionsAsync();
        if (accessPrivileges === "none" && canAskAgain) {  // ê¶Œí•œì„ ìš”ì²­í•˜ì§€ ì•Šì•„ì„œ accessê¶Œí•œì´ ì—†ëŠ” ê²½ìš°
            const permissions = await MediaLibrary.requestPermissionsAsync(); // ê¶Œí•œ ìš”ì²­
            if (accessPrivileges !== "none"){
                setOk(true);
            }
        } else if (accessPrivileges !== "none"){
            setOk(true);
        }
    }
    useEffect(() => {
        getPermissions();
    }, []) // í•œë²ˆë§Œ ì‹¤í–‰
```



2. ê°¤ëŸ¬ë¦¬ì—ì„œ ì‚¬ì§„ ê°€ì ¸ì˜¤ê¸°
   - getAssetsAsync

```js
const [photos, setPhotos] = useState([]); // array of photos (default : empty array)

const getPhotos = async () => {
    if (ok) {
        const {assets:photos} = await MediaLibrary.getAssetsAsync();  // array of photos
        setPhotos(photos)
    }
}

useEffect(() => {
    getPermissions();
    getPhotos();
}, [])
```

- ğŸ’¦  ì˜¤ë¥˜ê°€ í•˜ë‚˜ìˆìŒ : RELOADí•´ì„œ ì¹´ë©”ë¼ ì•„ì´ì½˜ í´ë¦­í–‡ê±° ë“¤ì–´ê°€ë©´ ì‚¬ì§„ì„ ì•ˆê°€ì ¸ì˜¤ê³  ê·¸ìƒíƒœì—ì„œ ì„¸ì´ë¸Œí•´ì„œ REFRESH í•˜ë©´ ì‚¬ì§„ ê°€ì ¸ì˜´

  - ë‹¤ìŒ ê°•ì˜ì—ì„œ í•´ê²° : getPhotos í•¨ìˆ˜ê°€ ì²˜ìŒë¶€í„° ì‹¤í–‰ë˜ì§€ ì•Šê³  ìˆê¸° ë•Œë¬¸

  - ìˆ˜ì • : 

    ```js
        const getPhotos = async () => { // if(ok) ì‚­ì œ
            const { assets: photos } = await MediaLibrary.getAssetsAsync();
            setPhotos(photos)
        }
        const getPermissions = async () => {
            const { accessPrivileges, canAskAgain } = await MediaLibrary.getPermissionsAsync();
            if (accessPrivileges === "none" && canAskAgain) {
                const { accessPrivileges } = await MediaLibrary.requestPermissionsAsync();
    
                if (accessPrivileges !== "none") {
                    setOk(true);
                    getPhotos();  // ì¶”ê°€
                }
            }
            else if (accessPrivileges !== "none") {
                setOk(true);
                getPhotos();  // ì¶”ê°€
            }
        }
        useEffect(() => {
            getPermissions();
            // getPhotos() ì‚­ì œ
        }, [])
    ```

    

### #17.4 Select Photo part 3

- ë°›ì•„ì˜¨ ì‚¬ì§„ë“¤ FlatListë¡œ ë Œë”í•˜ê¸°
  - numColumnsëŠ” ì™œì¸ì§€ ëª¨ë¥´ì§€ë§Œ `numColumns={4}`ì´ë ‡ê²Œ ë‹¤ì´ë ‰íŠ¸ë¡œ ê°’ì„ ì£¼ë©´ ì˜¤ë¥˜ë‚¨

```js
    const renderItem = ({ item: photo }) => {
        return (
            <TouchableOpacity>
                <Image source={{ uri: photo.uri }} style={{ width: 100, height: 100 }} />
            </TouchableOpacity>
        )
    }
    return (
        <Container>
            <Top />
            <Bottom>
                <FlatList
                    data={photos}
                    numColumns={numColumns}
                    keyExtractor={photo => photo.id}
                    renderItem={renderItem}
                />
            </Bottom>
        </Container>
    )
```

- ImageContainer, IconContainer(checkmark) ë¶„ë¦¬
  - IconContainer : `position : absolute` 



- ì‚¬ì§„ì„ ì„ íƒí•˜ë©´ top í™”ë©´ì— ë³´ì—¬ì£¼ê¸°

```js
const [chosenPhoto, setChosenPhoto] = useState("");

const choosePhoto = (uri) => {
        setChosenPhoto(uri);
    }

const renderItem = ({ item: photo }) => {
        return (
            <ImageContainer onPress={() => choosePhoto(photo.uri)}>
            ...
        
}
        
...
return (
        <Container>
            <Top>
                <Image source={{uri:chosenPhoto}} />
```

ğŸ’¦ ì²˜ìŒ ì¹´ë©”ë¼ ì•„ì´ì½˜ì„ í´ë¦­í–ˆì„ ë•Œ chosenPhoto(uri)ëŠ” ë¹ˆ ë¬¸ìì—´ì´ê¸° ë•Œë¬¸ì— image sourceë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ.

- ì¹´ë©”ë¼ ì•„ì´ì½˜ì„ í´ë¦­í–ˆì„ ë•Œ ê°€ì¥ ìµœê·¼ ì‚¬ì§„ì„ TOP í™”ë©´ì— ë„ìš°ëŠ” ê±¸ë¡œ

  ```js
      const getPhotos = async () => {
          const { assets: photos } = await MediaLibrary.getAssetsAsync();
          setPhotos(photos)
          setChosenPhoto(photos[0]?.uri);
      }
  ```

  ğŸ’¦ setChosenPhoto í•˜ê¸°ë„ ì „ì— renderë˜ê³  ìˆìŒ

  - chosenPhotoê°€ ë¹ˆ ë¬¸ìì—´ì¸ì§€ë¥¼ ìš°ì„  í™•ì¸

  ```js
  <Top>
      {chosenPhoto !== "" ? <Image source={{ uri: chosenPhoto }} /> : null}
  </Top>
  ```

  

### #17.5  Select Photo part 4

- chosenPhotoê°€ photo.uriì™€ ë™ì¼í•˜ë©´ ê·¸ ì‚¬ì§„ì€ ìœ ì €ê°€ ì„ íƒí•œ ì‚¬ì§„ => íŒŒë€ ì²´í¬ë§ˆí¬ë¡œ í‘œì‹œ

```js
<Ionicons
    name="checkmark-circle"
    size={18}
    color={photo.uri === chosenPhoto ? colors.blue : "white"}
/>
```

- upload ë²„íŠ¼ (í—¤ë”)
  - UploadNavì˜ Stack.Navigator screenOptionìœ¼ë¡œ ì£¼ê±°ë‚˜ (headerRight : ~)
  - selectPhotoì—ì„œ navigation.setOptions

```js
// SelectPhoto.js

const HeaderRight = () => {
    return (
        <TouchableOpacity>
        <HeaderRightText>Next</HeaderRightText>
        </TouchableOpacity>
    )
}

useEffect(() => {
    navigation.setOptions({
        headerRight: HeaderRight,
    })
}, [])
```



### #17.6 Take Photo part 1

- take photo screen : expo-camera

  usage : https://docs.expo.dev/versions/latest/sdk/camera/

- camera containerëŠ” ë°˜ë“œì‹œ `flex:1`



1. ê¶Œí•œ ìš”ì²­

```js
// TakePhoto.js

const [ok, setOk] = useState(false);
const getPermissions = async () => {
    const {granted} = await Camera.requestPermissionsAsync();
    setOk(granted);  // grantedê°€ trueë©´ setOk(true)
}
useEffect(()=>{
    getPermissions();
},[])
```

2. ì¹´ë©”ë¼ ì»´í¬ë„ŒíŠ¸

```js
const [cameraType, setCameraType] = useState(Camera.Constants.Type.back); // ê·¸ëƒ¥ "back" ì´ë¼ê³  í•˜ëŠ” ê²ƒë³´ë‹¤ constantsë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ê¶Œì¥ë¨

    return (
        <Container>
            <Camera
                Type={cameraType}
                style={{ flex: 1 }}
            />
            <Actions></Actions>  // ì´¬ì˜ë²„íŠ¼ ë‹´ì„ê³³
        </Container>
    )
```

- ì´¬ì˜ë²„íŠ¼ : ì½”ë“œ ì°¸ê³ 



### #17.7 Take Photo part 2

- ì „í›„ë©´ ì¹´ë©”ë¼ ì „í™˜ ë²„íŠ¼

```js
    const onCameraSwitch = () => {
        console.log(cameraType);
        if (cameraType === Camera.Constants.Type.front) {
            setCameraType(Camera.Constants.Type.back);
        } else {
            setCameraType(Camera.Constants.Type.front);
        }
        console.log(cameraType);

    }
```

- zoom ê¸°ëŠ¥
  - slider ì‚¬ìš©

```js
const [zoom, setZoom] = useState(0);
const onZoomValueChange = (e) => { // 0~1ê¹Œì§€ successiveí•œ ìˆ˜
    setZoom(e);
}
<Camera
    type={cameraType}
    style={{ flex: 1 }}
    zoom={zoom}
/>
                    
<Slider
    style={{ width: 200, height: 40 }}
    minimumValue={0}
    maximumValue={1}
    minimumTrackTintColor="#FFFFFF"
    maximumTrackTintColor="rgba(255,255,255,0.5)"
    onValueChange={onZoomValueChange}
/>
```



### #17.8 Take Photo part 3

- flashMode : ì½”ë“œ ì°¸ê³  (ì¹´ë©”ë¼ ì „í™˜ì´ë‘ ë¹„ìŠ·)
- ë‹«ê¸° ë²„íŠ¼ 
  - ê·¸ëƒ¥ ì¹´ë©”ë¼ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ë‹¤ ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸ ë„£ìœ¼ë©´ ë¨

ğŸ’¦ ì¹´ë©”ë¼ê°€ statusBar ê¹Œì§€ ì•ˆì˜¬ë¼ê° (statusbarê°€ íˆ¬ëª…í•´ì ¸ì•¼í•¨)

- select photoì—ì„œë„ ìœ„ì— ê³µê°„ ë‚¨ëŠ”ê±°ë³´ë‹ˆê¹Œ ê°™ì€ë¬¸ì œì¸ ê²ƒ ê°™ìŒ



### #17.9 Take Photo part 4

https://docs.expo.dev/versions/latest/sdk/camera/#takepictureasync

- ì‚¬ì§„ ì°ê¸°
  - ì¹´ë©”ë¼ ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•œ ë ˆí¼ëŸ°ìŠ¤

```js
const camera = useRef();
...
<Camera
    ...
    ref={camera}
>
```

- takePictureAsync()

- ì‚¬ìš©í•˜ê¸° ì „ì— onCameraReady ì½œë°± í•¨ìˆ˜ ì²˜ë¦¬ ê¸°ë‹¤ë ¤ì•¼í•¨

```js
const [cameraReady, setCameraReady] = useState(false);
...
const onCameraReady = () => setCameraReady(true);

```

```js
const takePhoto = async () => {
    if (camera.current && cameraReady) { // ì¹´ë©”ë¼ê°€ ì¡´ì¬ && ì¹´ë©”ë¼ê°€ ready
        const photo = await camera.current.takePictureAsync({
            quality: 1,  // 0~1(1ì´ ìµœëŒ€)
            exif: true,  // ì‚¬ì§„ì— ê´€í•œ ì˜¨ê°– ì •ë³´(height, width, uri ì¤‘ìš”)
        });
    }
}

<Camera
    ...
    ref={camera}
    onCameraReady={onCameraReady}
>
        
...
 <TakePhotoBtn onPress={takePhoto} />
```

- ì‚¬ì§„ ì €ì¥í•˜ê¸° => ë‹¤ìŒì‹œê°„ì—
